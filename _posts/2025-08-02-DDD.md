---
layout: post
title: DDD
date: 2025-01-11
categories: DDD
---


**限界上下文之间的映射关系**

- 合作关系（Partnership）：两个上下文紧密合作的关系，一荣俱荣，一损俱损。
- 共享内核（Shared Kernel）：两个上下文依赖部分共享的模型。
- 客户方-供应方开发（Customer-Supplier Development）：上下文之间有组织的上下游依赖。
- 遵奉者（Conformist）：下游上下文只能盲目依赖上游上下文。
- 防腐层（Anticorruption Layer）：一个上下文通过一些适配和转换与另一个上下文交互。
- 开放主机服务（Open Host Service）：定义一种协议来让其他上下文来对本上下文进行访问。
- 发布语言（Published Language）：通常与OHS一起使用，用于定义开放主机的协议。
- 大泥球（Big Ball of Mud）：混杂在一起的上下文关系，边界不清晰。
- 另谋他路（SeparateWay）：两个完全没有任何联系的上下文。

**实体**

当一个对象由其标识（而不是属性）区分时，这种对象称为实体（Entity）。

**例：最简单的，公安系统的身份信息录入，对于人的模拟，即认为是实体，因为每个人是独一无二的，且其具有唯一标识（如公安系统分发的身份证号码）。**

**值对象**

当一个对象用于对事务进行描述而没有唯一标识时，它被称作值对象（Value Object）。

**例：比如颜色信息，我们只需要知道{“name”:“黑色”，”css”:“#000000”}这样的值信息就能够满足要求了，这避免了我们对标识追踪带来的系统复杂性。**

值对象很重要，在习惯了使用数据库的数据建模后，很容易将所有对象看作实体。使用值对象，可以更好地做系统优化、精简设计。

**它具有不变性、相等性和可替换性。**

在实践中，需要保证**值对象创建后就不能被修改，即不允许外部再修改其属性**。在不同上下文集成时，会出现模型概念的公用，如商品模型会存在于电商的各个上下文中。在订单上下文中如果你只关注下单时商品信息快照，那么将商品对象视为值对象是很好的选择。

**聚合根**

**Aggregate(聚合）是一组相关对象的集合，作为一个整体被外界访问，聚合根（Aggregate Root）是这个聚合的根节点。**

<p align="center"><img src="assets/img/ddd-dto-do-po.png" width="200" /></p>



首先领域的开放服务通过信息传输对象（DTO）来完成与外界的数据交互；

在领域内部，我们通过领域对象（DO）作为领域内部的数据和行为载体；

在资源库内部，我们沿袭了原有的数据库持久化对象（PO）进行数据库资源的交互。

同时，DTO与DO的转换发生在领域服务内，DO与PO的转换发生在资源库内。

<p align="center"><img src="assets/img/ddd.png" width="400" /></p>

![](assets/img/ddd-mt.png)